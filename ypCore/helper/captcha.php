<?phpfunction ypCaptcha($param = array()) {	$width = $param['width'] ? $param['width'] : 70;	$height = $param['height'] ? $param['height'] : 28;	$strlen = $param['strlen'] ? $param['strlen'] : 4;	$sessionname = $param['session_name'] ? $param['session_name'] : 'captcha_code';	$background_color['r'] = isset($param['r']) ? $param['r'] : 247;	$background_color['b'] = isset($param['b']) ? $param['b'] : 247;	$background_color['g'] = isset($param['g']) ? $param['g'] : 247;	$strlen = intval($strlen);	$font = YPCORE_ROOT . '/' . YPCORE_DIR . '/helper/fonts/monofont.ttf';	$possible = '123456789bcdfghjkmnpqrstvwxyz';	$code = '';	$i = 0;	while ($i < $strlen) { 		$code .= substr($possible, mt_rand(0, strlen($possible)-1), 1);		$i++;	}	$font_size = $height * 0.75;	$image = @imagecreate($width, $height) or trigger_error('Captcha():: Cannot initialize new GD image stream');	$background_color = imagecolorallocate($image, intval($background_color['r']), intval($background_color['b']), $background_color['g']);	$text_color = imagecolorallocate($image, 0, 0, 0);	$noise_color = imagecolorallocate($image, 166, 165, 165);	for( $i=0; $i<3; $i++ ) {		imagefilledellipse($image, mt_rand(0,$width), mt_rand(0,$height), 1, 1, $noise_color);	}	for( $i=0; $i<5; $i++ ) {		imageline($image, mt_rand(0,$width), mt_rand(0,$height), mt_rand(0,$width), mt_rand(0,$height), $noise_color);	}	$textbox = imagettfbbox($font_size, 0, $font, $code) or trigger_error('Captcha():: Error in imagettfbbox function');	$x = ($width - $textbox[4])/2;	$y = ($height - $textbox[5])/2;	imagettftext($image, $font_size, 0, $x, $y, $text_color, $font , $code) or trigger_error('Captcha():: Error in imagettftext function');	header('Content-Type: image/jpeg');	imagejpeg($image);	imagedestroy($image);	$prefix = substr(md5($sessionname), 0, 5);	$_SESSION[$prefix . $sessionname] = $code;}