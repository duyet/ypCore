<?php class Model_Admin_Admin_Admin extends ypModel {	public function isLogin() {		if (!$this->User->isAdmin()) {			return FALSE;		}		$sessionAdmin = (string) $this->Session->get('admin');		if ($sessionAdmin) {			return TRUE;		}				$cookieAdmin = $this->Cookie->get('admin');		$cookieAdminCode = $this->Cookie->get('admin_code');		if (!$cookieAdmin OR !$cookieAdminCode) {			return FALSE;		}		$decode = $this->Crypt->userLoginInfoDecode($cookieAdminCode);		if (!$decode OR $decode['username'] != $cookieAdmin) {			return FALSE;		}		// Admin last login. And cookie is exists, then I save it to session		$this->Session->set('admin', $cookieAdmin);		return TRUE;	}	public function loadAdmin() {		return $this->user->getData();	}	public function adminLogs($username, $mess) {		$username = $this->Db->e($username);		$mess = $this->Db->e($mess);		$time = time();		$ip = $this->Request->ip;		$user_agent = $this->Db->e($this->Request->userAgent);		$url = $this->Db->e(urlencode($this->Link->build($this->Link->this(), TRUE, $this->Link->getParams())));				return $this->Db->query("INSERT INTO `yp_admin_logs` (`username`, `message`, `time`, `ip`, `user_agent`, `url`) 		VALUES ('$username', '$mess', $time, '$ip', '$user_agent', '$url')");	}}